---
tags:
  - concept
parent_concept:
---
**GPU 커널(Kernel)**은 한마디로 **"GPU 위에서 실행되는 함수"**입니다.


### 1. 정의 및 핵심 개념

일반적인 C++ 함수가 CPU에서 **순차적(Serial)**으로 한 번에 하나씩 실행된다면, 커널(Kernel)은 GPU에서 수천, 수만 개의 스레드(Thread)에 의해 **병렬(Parallel)**로 동시에 실행되는 함수입니다.

이것을 **SIMT (Single Instruction, Multiple Threads)** 구조라고 합니다.

- **Single Instruction:** "이 함수(커널)를 실행해라"라는 코드는 딱 하나지만,
    
- **Multiple Threads:** 그 코드를 수많은 일꾼(스레드)들이 각자 자기 구역의 데이터를 들고 동시에 수행합니다.
    

### 2. 코드에서의 식별 (CUDA 기준)

이전에 질문하신 `.cu` 파일 안에서 커널은 다음과 같은 특징을 가집니다.

#### A. 선언 (`__global__`)

함수 앞에 `__global__`이라는 키워드가 붙습니다. "이 함수는 CPU(Host)에서 호출되지만, 실행은 GPU(Device)에서 한다"는 뜻입니다.

C++

```
__global__ void addKernel(int *a, int *b, int *c) {
    // 여기에 작성된 코드는 수많은 스레드가 동시에 각자 실행합니다.
}
```

#### B. 호출 (`<<< >>>`)

일반 함수 호출과 다르게 꺽쇠 괄호 3개를 사용합니다.

C++

```
// 1개의 블록(Block)안에 256개의 스레드(Thread)를 만들어서 일을 시켜라!
addKernel<<<1, 256>>>(d_a, d_b, d_c);
```

### 3. 작동 원리: "나는 누구인가?"

커널 함수 코드는 모든 스레드에게 똑같이 복사됩니다. 그렇다면 스레드들은 어떻게 서로 다른 데이터(예: 이미지의 서로 다른 픽셀)를 처리할까요?

바로 **"자신의 고유 번호(Index)"**를 계산해서 자기 몫을 찾습니다.

- 커널 내부에는 `threadIdx`, `blockIdx` 같은 내장 변수가 있어서, 스레드가 "아, 나는 5번째 스레드구나. 그럼 배열의 5번째 인덱스를 처리해야지"라고 판단합니다.
    

> **비유:**
> 
> - **CPU 함수:** 교수님(CPU) 한 분이 시험지 100장을 **혼자서 1번부터 100번까지 차례대로** 채점합니다. (Loop 문)
>     
> - **GPU 커널:** 조교(스레드) 100명을 불러놓고, "각자 자기가 맡은 번호의 시험지를 채점해라"라고 **지시 사항(커널)** 하나를 방송합니다. 채점은 **순식간에 동시에** 끝납니다.
>     

### 4. CVML(컴퓨터 비전)에서의 활용

연구실에서 다루게 될 컴퓨터 비전 분야에서 커널은 필수적입니다.

- **이미지 처리:** $1920 \times 1080$ 크기의 이미지가 있을 때, 커널을 실행하여 약 200만 개의 스레드를 생성합니다. 각 스레드가 픽셀 하나씩 맡아서 밝기를 조절하거나 필터를 씌우면, CPU가 `for` 문을 200만 번 도는 것보다 압도적으로 빠릅니다.
    
- **행렬 연산:** 딥러닝이나 SLAM에서 쓰이는 거대한 행렬 곱셈도 커널을 통해 병렬로 처리합니다.
    

---

**요약하자면:**

GPU 커널은 **"수많은 스레드가 동시에 수행하도록 설계된 병렬처리용 함수"**입니다.

